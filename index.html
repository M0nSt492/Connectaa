<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Flappy Connecta</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #000;
    touch-action: manipulation;
    position: relative;
  }

  canvas {
    position: absolute;
    top: 0;
    left: 0;
    touch-action: manipulation;
  }

  #overlay {
    position: absolute;
    width: 100%;
    text-align: center;
    color: #fff;
    font-family: Monaco;
    pointer-events: none;
  }

  #overlay button {
    pointer-events: auto;
    padding: 10px 20px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    background: rgba(255,255,255,0.85);
    margin-top: 12px;
    cursor: pointer;
  }
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="overlay">
  <h1>Flappy Connecta</h1>
  <p>Toca no ecr√£ para jogar ‚Äî O Pai Natal est√° √† espera!</p>
  <button id="startBtn">Come√ßar</button>
</div>

<script>
const GAME_W = 480;
const GAME_H = 640;

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = GAME_W;
canvas.height = GAME_H;

const overlay = document.getElementById("overlay");
const startBtn = document.getElementById("startBtn");

// imagens
const bgImg = new Image(); bgImg.src = "menuu.jpg";
const santaImg = new Image(); santaImg.src = "santa.png";
const logoImg = new Image(); logoImg.src = "connecta.png";

// jogador
let player = { x: 100, y: GAME_H/4, w:48, h:48, vy:0, rotation:0 };
let pipes = [];
let gravity = 0.5;
let flapStrength = -6;
let pipeGap = 150;
let pipeSpeed = 3;
let pipeWidth = 60;
let pipeInterval = 1400;
let lastPipeTime = 0;
let score = 0;
let best = Number(localStorage.getItem("flappy_connecta_best") || 0);
let started = false;
let gameOver = false;

function resetGame(){
    pipes = [];
    player.y = GAME_H/4;
    player.vy = 0;
    player.rotation = 0;
    score = 0;
    started = false;
    gameOver = false;

    overlay.style.display = "block";
    overlay.innerHTML = `
      <h1>Flappy Connecta</h1>
      <p>Toca no ecr√£ para jogar ‚Äî O Pai Natal est√° √† espera!</p>
      <button id="startBtn">Come√ßar</button>
    `;
    document.getElementById("startBtn").addEventListener("touchstart", flap, {passive:false});
}

function spawnPipe(){
    const minTop = 60;
    const maxTop = GAME_H - pipeGap - 60;
    const top = Math.floor(Math.random() * (maxTop - minTop)) + minTop;
    pipes.push({x: GAME_W + 20, top: top, scored:false});
}

function flap(e){
    if(e) e.preventDefault();

    if(gameOver){
        resetGame();
        return;
    }
    started = true;
    overlay.style.display = "none";
    player.vy = flapStrength;
    player.rotation = -0.6;
}

function rectsIntersect(a,b){
    return !(a.x + a.w < b.x || a.x > b.x + b.w || a.y + a.h < b.y || a.y > b.y + b.h);
}

function update(dt){
    if(!started || gameOver) return;

    player.vy += gravity;
    player.y += player.vy * (dt/16.66);
    player.rotation = Math.max(Math.min(player.vy/12, 1.2), -1.2);

    if(performance.now() - lastPipeTime > pipeInterval){
        spawnPipe();
        lastPipeTime = performance.now();
    }

    for(let i = pipes.length-1; i >= 0; i--){
        let p = pipes[i];
        p.x -= pipeSpeed * (dt/16.66);

        if(!p.scored && p.x + pipeWidth < player.x){
            p.scored = true;
            score++;
            if(score > best){
                best = score;
                localStorage.setItem("flappy_connecta_best", best);
            }
        }

        if(p.x + pipeWidth < -20) pipes.splice(i,1);

        const playerRect = {x: player.x-player.w/2, y:player.y-player.h/2, w:player.w, h:player.h};
        const pipeTopRect = {x:p.x, y:0, w:pipeWidth, h:p.top};
        const pipeBottomRect = {x:p.x, y:p.top+pipeGap, w:pipeWidth, h:GAME_H-(p.top+pipeGap)};

        if(rectsIntersect(playerRect, pipeTopRect) || rectsIntersect(playerRect, pipeBottomRect)){
            gameOver = true;
            overlay.style.display = "block";
            overlay.innerHTML = `
              <h1>Distribuiste ${score} presente${score!==1?'s':''} üéÅ</h1>
              <button id="startBtn">Tentar novamente</button>
            `;
            document.getElementById("startBtn").addEventListener("touchstart", flap, {passive:false});
        }
    }

    const half = player.h/2;
    if(player.y + half > GAME_H){ gameOver = true; overlay.style.display = "block"; }
    if(player.y - half < 0) { player.y = half; player.vy = 0; }
}

function draw(){
    if(bgImg.complete) ctx.drawImage(bgImg,0,0,GAME_W,GAME_H);

    // logo no centro em baixo
    if(logoImg.complete){
        const W = 160, H = 50;
        const x = (GAME_W - W)/2;
        const y = GAME_H - H - 12;
        ctx.drawImage(logoImg, x, y, W, H);
    }

    // pipes
    ctx.fillStyle = "#B22222";
    for(let p of pipes){
        ctx.fillRect(p.x, p.top+pipeGap, pipeWidth, GAME_H-(p.top+pipeGap));
        ctx.fillRect(p.x, 0, pipeWidth, p.top);
    }

    // jogador
    ctx.save();
    ctx.translate(player.x, player.y);
    ctx.rotate(player.rotation);
    if(santaImg.complete)
        ctx.drawImage(santaImg, -player.w/2, -player.h/2, player.w, player.h);
    ctx.restore();

    // UI
    ctx.fillStyle="#fff";
    ctx.textAlign="center";
    ctx.font="28px Monaco";
    ctx.fillText(`Score: ${score}`, GAME_W/2, 48);

   ctx.textAlign = "center";
ctx.font = "18px Monaco";
ctx.fillText(`Best: ${best}`, GAME_W / 2, 75);

}

// redimensionar e manter 100% fullscreen
function resizeCanvas(){
    const sw = window.innerWidth;
    const sh = window.innerHeight;

    const scale = Math.max(sw / GAME_W, sh / GAME_H);

    const newW = GAME_W * scale;
    const newH = GAME_H * scale;

    canvas.style.width = newW + "px";
    canvas.style.height = newH + "px";
    canvas.style.left = (sw - newW)/2 + "px";
    canvas.style.top  = (sh - newH)/2 + "px";

    overlay.style.top = sh * 0.35 + "px";
    overlay.style.width = sw + "px";
}

window.addEventListener("resize", resizeCanvas);
resizeCanvas();

let lastTime = performance.now();
function loop(now){
    const dt = now - lastTime;
    lastTime = now;
    update(dt);
    draw();
    requestAnimationFrame(loop);
}

canvas.addEventListener("touchstart", flap, {passive:false});

loop(performance.now());
</script>

</body>
</html>

















